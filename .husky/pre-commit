#!/bin/sh
# Pre-commit hook for SIM project

cd development/test_website

echo "ğŸ” Running ESLint..."
npm run lint || exit 1

echo "âœ… Linting passed!"
echo ""
echo "ğŸ§ª Running tests..."
npm test || exit 1

echo "âœ… Tests passed!"
echo ""

# Go back to repo root for deployment doc validation
cd ../..

# Optional: AI-powered deployment doc validation
# Only runs if ANTHROPIC_API_KEY is set (local dev)
if [ -n "$ANTHROPIC_API_KEY" ]; then
  echo "ğŸ“‹ Validating deployment documentation with AI..."
  npm run validate:deployment || {
    echo ""
    echo "âŒ Deployment documentation validation failed!"
    echo "Review the errors above and update your deployment doc."
    echo ""
    echo "ğŸ’¡ To bypass (emergency only): git commit --no-verify"
    exit 1
  }
  echo "âœ… Deployment doc validated!"
else
  echo "â­ï¸  Skipping deployment doc validation (no ANTHROPIC_API_KEY)"
  echo "   Will run in CI on pull request"
fi

echo ""
echo "âœ¨ Pre-commit checks complete!"
